apiVersion: camel.apache.org/v1alpha1
kind: Kamelet
metadata:
  name: generic-exception-handler
  labels:
    camel.apache.org/kamelet.type: "source"

spec:
  definition:
    title: "Exception Handler Response for non-specific exceptions"
    description:
      Generate error response based for non-specific exceptions.
    type: object
    properties:
      statusCode:
        title: Http status code
        description: Http status code
        type: integer
        default: 500

  types:
    out:
      mediaType: application/json
  dependencies:
  template:
    from:
      uri: "kamelet:source"
      steps:
        - log:
            loggingLevel: ERROR
            message: "Error occurred: ${exception}"
        - set-header:
            name: "CamelHttpResponseCode"
            constant: "{{statusCode}}"
        - set-header:
            name: "Content-Type"
            constant: "application/json"
        - set-body:
            simple: "{ \"errorCode\":\"GC027\", \"errorMessages\": [{ \"gc\":\"Unexpected error occurred within service\"}]}"